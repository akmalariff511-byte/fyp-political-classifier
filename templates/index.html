<!DOCTYPE html>
<html>
<head>
  <title>FYP Political Classifier</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    textarea { width: 100%; max-width: 900px; }
    .box { background:#f5f5f5; padding:15px; border-radius:10px; max-width: 900px; }
    .row { margin: 8px 0; }
    .label { display:inline-block; width: 160px; font-weight: bold; }
    .badge { padding: 2px 8px; border-radius: 8px; background: #eaeaea; }
  </style>
</head>
<body>

  <h1>Website is running âœ…</h1>
  <p>Test ayat di bawah (akan hantar ke <code>/predict</code>).</p>

  <textarea id="textInput" rows="6" placeholder="Taip ayat di sini..."></textarea>
  <br><br>
  <button onclick="sendText()">Predict</button>

  <h2>Response</h2>

  <div class="box">
    <div class="row"><span class="label">Political Topic:</span> <span id="pLabel" class="badge">-</span> (<span id="pConf">-</span>)</div>
    <div class="row"><span class="label">Target:</span> <span id="tLabel" class="badge">-</span> (<span id="tConf">-</span>)</div>
    <div class="row"><span class="label">Hate Speech:</span> <span id="hLabel" class="badge">-</span> (<span id="hConf">-</span>)</div>
    <div class="row"><span class="label">Emotion:</span> <span id="eLabel" class="badge">-</span> (<span id="eConf">-</span>)</div>
  </div>

  <h3>Raw JSON</h3>
  <pre id="raw">{}</pre>

<script>
async function sendText() {
  const text = document.getElementById("textInput").value;

  const res = await fetch("/predict", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ text })
  });

  const data = await res.json();

  // paparkan raw JSON
  document.getElementById("raw").innerText = JSON.stringify(data, null, 2);

  // ambil output ikut format Step 1 (multi-task)
  const pred = data.predictions || {};

  document.getElementById("pLabel").innerText = pred.political_topic?.label ?? "-";
  document.getElementById("pConf").innerText  = pred.political_topic?.confidence ?? "-";

  document.getElementById("tLabel").innerText = pred.target?.label ?? "-";
  document.getElementById("tConf").innerText  = pred.target?.confidence ?? "-";

  document.getElementById("hLabel").innerText = pred.hate_speech?.label ?? "-";
  document.getElementById("hConf").innerText  = pred.hate_speech?.confidence ?? "-";

  document.getElementById("eLabel").innerText = pred.emotion?.label ?? "-";
  document.getElementById("eConf").innerText  = pred.emotion?.confidence ?? "-";
}
</script>

</body>
</html>
