<!DOCTYPE html>
<html>
<head>
  <title>FYP Political Classifier</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    textarea { width: 100%; max-width: 900px; }
    .box { background:#f5f5f5; padding:15px; border-radius:10px; max-width: 900px; }
    .row { margin: 8px 0; }
    .label { display:inline-block; width: 160px; font-weight: bold; }
    .badge { padding: 2px 8px; border-radius: 8px; background: #eaeaea; }
    pre { background:#111; color:#eee; padding:12px; border-radius:10px; max-width:900px; }
  </style>
</head>
<body>

<h1>Website is running âœ…</h1>
<p>Test ayat di bawah (akan hantar ke <code>/predict</code>).</p>

<textarea id="textInput" rows="6">anwar terbaik</textarea>
<br><br>
<button onclick="sendText()">Predict</button>

<h2>Response</h2>

<div class="box">
  <div class="row"><span class="label">Political:</span> <span id="pLabel" class="badge">-</span> (<span id="pConf">-</span>)</div>
  <div class="row"><span class="label">Target:</span> <span id="tLabel" class="badge">-</span> (<span id="tConf">-</span>)</div>
  <div class="row"><span class="label">Hate:</span> <span id="hLabel" class="badge">-</span> (<span id="hConf">-</span>)</div>
  <div class="row"><span class="label">Emotion:</span> <span id="eLabel" class="badge">-</span> (<span id="eConf">-</span>)</div>
</div>

<h3>Raw JSON</h3>
<pre id="raw">{}</pre>

<script>
const EMOTION_LABELS = [
  "anger","anticipation","disgust","fear",
  "happy","sadness","surprise","trust"
];

const TARGET_LABELS = [
  "gov","none","person","political group"
];

function pct(x) {
  if (x === undefined || x === null) return "-";
  return (x * 100).toFixed(2) + "%";
}

async function sendText() {
  const text = document.getElementById("textInput").value;

  const res = await fetch("/predict", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ text })
  });

  const data = await res.json();
  document.getElementById("raw").innerText = JSON.stringify(data, null, 2);

  document.getElementById("pLabel").innerText =
    data.political?.prob >= 0.5 ? "political" : "non-political";
  document.getElementById("pConf").innerText = pct(data.political?.prob);

  document.getElementById("hLabel").innerText =
    data.hate?.prob >= 0.5 ? "hate" : "none";
  document.getElementById("hConf").innerText = pct(data.hate?.prob);

  const t = data.target?.pred;
  document.getElementById("tLabel").innerText = TARGET_LABELS[t];
  document.getElementById("tConf").innerText = pct(data.target?.probs?.[t]);

  const e = data.emotion?.pred;
  document.getElementById("eLabel").innerText = EMOTION_LABELS[e];
  document.getElementById("eConf").innerText = pct(data.emotion?.probs?.[e]);
}
</script>

</body>
</html>
